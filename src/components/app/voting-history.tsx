"use client";

import React from "react";
import { VotingHistoryItem } from "@/types/delegate";

interface VotingHistoryProps {
    data: VotingHistoryItem[];
    totalCount: number;
}

const VotingHistory = ({ data, totalCount }: VotingHistoryProps) => {
    return (
        <div className="w-full">
            <h2 className="flex items-center gap-[4px] w-full p-[16px] border-b-[0.5px] border-[#E7E7E7] dark:border-[#282828] font-(family-name:--font-geist-sans) font-medium text-[16px] leading-[100%] tracking-[0%] text-[#101828] dark:text-white">
                Proposals <span className="font-(family-name:--font-geist-sans) font-normal text-[12px] leading-[100%] tracking-[0%] text-[#101828B2] dark:text-gray-400">({totalCount})</span>
            </h2>

            <div className="flex flex-col gap-4 bg-gray-50/50 dark:bg-transparent p-4">
                {data.map((proposal, index) => (
                    <div
                        key={index}
                        className="bg-white dark:bg-[#0A0A0A] border border-gray-100 dark:border-[#282828] rounded-xl p-4 md:p-5 cursor-pointer transition-shadow"
                        style={{ boxShadow: '0px 1px 40px 0px #1018280D' }}
                    >
                        <div className="flex items-start justify-between">
                            <div className="flex flex-col gap-1 w-full">
                                {/* Status Line */}
                                <div className="flex items-center gap-1.5 text-xs md:text-sm mb-1">
                                    {getStatusIcon(proposal.status)}

                                    <span className={`${getStatusColor(proposal.status)} text-[12px] leading-[100%] tracking-[0%] font-normal font-(family-name:--font-geist-sans)`}>
                                        {proposal.status}
                                    </span>

                                    {proposal.status === "Active" && proposal.hoursLeft && (
                                        <>
                                            <span className="text-[#909090] dark:text-gray-500 text-[12px] leading-[100%] font-normal font-(family-name:--font-geist-sans)">
                                                {proposal.hoursLeft} hours left!
                                            </span>
                                            <span className="text-gray-300 dark:text-gray-700">-</span>
                                        </>
                                    )}

                                    {proposal.status !== "Active" && <span className="text-gray-300 dark:text-gray-700">-</span>}

                                    <span className={`${getVoteColor(proposal.voteChoice)} font-(family-name:--font-geist-sans) font-normal text-[12px] leading-[100%] tracking-[0%]`}>
                                        Voted: {proposal.voteChoice}
                                    </span>
                                </div>

                                {/* Title */}
                                <h3 className="font-(family-name:--font-geist-sans) font-medium text-[16px] leading-[24px] text-[#101828] dark:text-gray-200">
                                    {proposal.proposalName}
                                </h3>

                                {/* Metadata */}
                                <p className="font-(family-name:--font-geist-sans) font-normal text-[14px] leading-[100%] tracking-[0%] text-[#909090] dark:text-gray-500 mt-1">
                                    Published on {new Date(proposal.proposalCreatedAt).toLocaleDateString()} by {proposal.proposalCreator.slice(0, 6)}...{proposal.proposalCreator.slice(-4)}
                                </p>
                            </div>

                            <button className="text-gray-400 mt-1">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={2} stroke="currentColor" className="w-5 h-5">
                                    <path strokeLinecap="round" strokeLinejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" />
                                </svg>
                            </button>
                        </div>
                    </div>
                ))}
            </div>
        </div>
    );
};

// Helper for status colors
const getStatusColor = (status: VotingHistoryItem["status"]) => {
    switch (status) {
        case "Active":
            return "text-[#8E55EA]"; // Purple-ish
        case "Succeeded":
            return "text-[#34C759]"; // Green
        case "Defeated":
            return "text-[#FF3B30]"; // Red
        case "Executable":
            return "text-[#34C759]"; // Green
        default:
            return "text-gray-500 dark:text-gray-400";
    }
};

const getVoteColor = (vote: VotingHistoryItem["voteChoice"]) => {
    switch (vote) {
        case "Approve":
            return "text-[#00AA09]";
        case "Deny":
            return "text-[#D70000]";
        default:
            return "text-[#00AA09]";
    }
}

// Helper for status icons
const getStatusIcon = (status: VotingHistoryItem["status"]) => {
    switch (status) {
        case "Active":
            return (
                <svg width="14" height="10" viewBox="0 0 14 10" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M2.89617 0.195371C2.95815 0.257286 3.00732 0.330812 3.04087 0.411744C3.07442 0.492676 3.09169 0.579427 3.09169 0.667038C3.09169 0.754648 3.07442 0.841399 3.04087 0.922331C3.00732 1.00326 2.95815 1.07679 2.89617 1.1387C1.89579 2.13925 1.3338 3.49617 1.3338 4.91104C1.3338 6.3259 1.89579 7.68283 2.89617 8.68337C2.95984 8.74487 3.01063 8.81843 3.04557 8.89977C3.08051 8.9811 3.0989 9.06858 3.09967 9.1571C3.10044 9.24562 3.08357 9.33341 3.05005 9.41534C3.01653 9.49727 2.96703 9.57171 2.90443 9.6343C2.84184 9.6969 2.7674 9.7464 2.68547 9.77992C2.60354 9.81344 2.51575 9.83031 2.42723 9.82954C2.33871 9.82877 2.25123 9.81038 2.1699 9.77544C2.08856 9.7405 2.015 9.68971 1.9535 9.62604C-0.651167 7.02204 -0.651167 2.79937 1.9535 0.195371C2.07852 0.0703903 2.24806 0.000179927 2.42483 0.000179927C2.60161 0.000179927 2.77115 0.0703903 2.89617 0.195371ZM11.3842 0.195371C13.9882 2.80004 13.9882 7.02204 11.3842 9.62604C11.2592 9.75113 11.0896 9.82144 10.9127 9.82151C10.7359 9.82157 10.5663 9.75138 10.4412 9.62637C10.3161 9.50137 10.2458 9.33179 10.2457 9.15494C10.2456 8.97809 10.3158 8.80847 10.4408 8.68337C11.4412 7.68283 12.0032 6.3259 12.0032 4.91104C12.0032 3.49617 11.4412 2.13925 10.4408 1.1387C10.3157 1.01361 10.2455 0.843947 10.2455 0.667038C10.2455 0.490128 10.3157 0.320465 10.4408 0.195371C10.5659 0.0702772 10.7356 3.4873e-09 10.9125 0C11.0894 -3.48731e-09 11.2591 0.0702772 11.3842 0.195371ZM4.87417 2.11137C4.99915 2.23639 5.06936 2.40593 5.06936 2.5827C5.06936 2.75948 4.99915 2.92902 4.87417 3.05404C4.63147 3.29671 4.43895 3.58482 4.3076 3.9019C4.17625 4.21898 4.10865 4.55883 4.10865 4.90204C4.10865 5.24525 4.17625 5.5851 4.3076 5.90218C4.43895 6.21926 4.63147 6.50736 4.87417 6.75004C4.93606 6.81198 4.98515 6.8855 5.01863 6.96641C5.05212 7.04733 5.06933 7.13404 5.0693 7.22161C5.06927 7.30917 5.05199 7.39587 5.01845 7.47676C4.98492 7.55765 4.93577 7.63114 4.87383 7.69304C4.81189 7.75493 4.73837 7.80402 4.65746 7.83751C4.57654 7.87099 4.48983 7.8882 4.40226 7.88817C4.3147 7.88814 4.228 7.87086 4.14711 7.83733C4.06622 7.80379 3.99273 7.75464 3.93083 7.6927C3.19072 6.95257 2.77493 5.94874 2.77493 4.90204C2.77493 3.85534 3.19072 2.85151 3.93083 2.11137C3.99275 2.04939 4.06627 2.00021 4.14721 1.96666C4.22814 1.93311 4.31489 1.91585 4.4025 1.91585C4.49011 1.91585 4.57686 1.93311 4.65779 1.96666C4.73873 2.00021 4.81225 2.04939 4.87417 2.11137ZM9.51283 2.11137C10.2529 2.85151 10.6687 3.85534 10.6687 4.90204C10.6687 5.94874 10.2529 6.95257 9.51283 7.6927C9.3871 7.81414 9.2187 7.88134 9.0439 7.87982C8.8691 7.8783 8.70189 7.80819 8.57829 7.68458C8.45468 7.56098 8.38457 7.39377 8.38305 7.21897C8.38153 7.04417 8.44873 6.87577 8.57017 6.75004C8.81287 6.50736 9.00539 6.21926 9.13674 5.90218C9.26808 5.5851 9.33569 5.24525 9.33569 4.90204C9.33569 4.55883 9.26808 4.21898 9.13674 3.9019C9.00539 3.58482 8.81287 3.29671 8.57017 3.05404C8.44873 2.9283 8.38153 2.7599 8.38305 2.5851C8.38457 2.41031 8.45468 2.2431 8.57829 2.11949C8.70189 1.99589 8.8691 1.92577 9.0439 1.92425C9.2187 1.92274 9.3871 1.98993 9.51283 2.11137ZM6.72217 3.95804C6.98738 3.95804 7.24174 4.06339 7.42927 4.25093C7.61681 4.43847 7.72217 4.69282 7.72217 4.95804C7.72217 5.22325 7.61681 5.47761 7.42927 5.66514C7.24174 5.85268 6.98738 5.95804 6.72217 5.95804C6.45695 5.95804 6.2026 5.85268 6.01506 5.66514C5.82752 5.47761 5.72217 5.22325 5.72217 4.95804C5.72217 4.69282 5.82752 4.43847 6.01506 4.25093C6.2026 4.06339 6.45695 3.95804 6.72217 3.95804Z" fill="url(#paint0_linear_281_4278)" />
                    <defs>
                        <linearGradient id="paint0_linear_281_4278" x1="13.3372" y1="4.91478" x2="0" y2="4.91478" gradientUnits="userSpaceOnUse">
                            <stop stopColor="#22E9AD" />
                            <stop offset="1" stopColor="#9846FE" />
                        </linearGradient>
                    </defs>
                </svg>
            );
        case "Succeeded":
            return (
                <svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M6.45046 1.18579C6.57542 1.04852 6.72766 0.938847 6.89745 0.863805C7.06724 0.788762 7.25083 0.75 7.43646 0.75C7.62209 0.75 7.80568 0.788762 7.97546 0.863805C8.14525 0.938847 8.2975 1.04852 8.42246 1.18579L9.10246 1.93246C9.23449 2.0774 9.39686 2.19144 9.578 2.26646C9.75915 2.34148 9.95461 2.37562 10.1505 2.36646L11.1591 2.31979C11.3445 2.31106 11.5296 2.34111 11.7027 2.40802C11.8758 2.47494 12.033 2.57724 12.1642 2.70839C12.2955 2.83953 12.398 2.99664 12.465 3.16965C12.5321 3.34266 12.5623 3.52776 12.5538 3.71312L12.5065 4.72246C12.4973 4.91831 12.5314 5.11377 12.6065 5.29491C12.6815 5.47606 12.7955 5.63843 12.9405 5.77046L13.6871 6.45046C13.8244 6.57542 13.9341 6.72766 14.0091 6.89745C14.0842 7.06724 14.1229 7.25083 14.1229 7.43646C14.1229 7.62209 14.0842 7.80568 14.0091 7.97546C13.9341 8.14525 13.8244 8.2975 13.6871 8.42246L12.9405 9.10246C12.7955 9.23449 12.6815 9.39686 12.6065 9.578C12.5314 9.75915 12.4973 9.95461 12.5065 10.1505L12.5531 11.1591C12.5619 11.3445 12.5318 11.5296 12.4649 11.7027C12.398 11.8758 12.2957 12.033 12.1645 12.1642C12.0334 12.2955 11.8763 12.398 11.7033 12.465C11.5303 12.5321 11.3452 12.5623 11.1598 12.5538L10.1505 12.5065C9.95461 12.4973 9.75915 12.5314 9.578 12.6065C9.39686 12.6815 9.23449 12.7955 9.10246 12.9405L8.42246 13.6871C8.2975 13.8244 8.14525 13.9341 7.97546 14.0091C7.80568 14.0842 7.62209 14.1229 7.43646 14.1229C7.25083 14.1229 7.06724 14.0842 6.89745 14.0091C6.72766 13.9341 6.57542 13.8244 6.45046 13.6871L5.77046 12.9405C5.63843 12.7955 5.47606 12.6815 5.29491 12.6065C5.11377 12.5314 4.91831 12.4973 4.72246 12.5065L3.71379 12.5531C3.52844 12.5619 3.3433 12.5318 3.17023 12.4649C2.99716 12.398 2.83995 12.2957 2.70868 12.1645C2.57741 12.0334 2.47496 11.8763 2.40788 11.7033C2.3408 11.5303 2.31057 11.3452 2.31912 11.1598L2.36646 10.1505C2.37562 9.95461 2.34148 9.75915 2.26646 9.578C2.19144 9.39686 2.0774 9.23449 1.93246 9.10246L1.18579 8.42246C1.04852 8.2975 0.938847 8.14525 0.863805 7.97546C0.788762 7.80568 0.75 7.62209 0.75 7.43646C0.75 7.25083 0.788762 7.06724 0.863805 6.89745C0.938847 6.72766 1.04852 6.57542 1.18579 6.45046L1.93246 5.77046C2.0774 5.63843 2.19144 5.47606 2.26646 5.29491C2.34148 5.11377 2.37562 4.91831 2.36646 4.72246L2.31979 3.71379C2.31106 3.52844 2.34111 3.3433 2.40802 3.17023C2.47494 2.99716 2.57724 2.83995 2.70839 2.70868C2.83953 2.57741 2.99664 2.47496 3.16965 2.40788C3.34266 2.3408 3.52776 2.31057 3.71312 2.31912L4.72246 2.36646C4.91831 2.37562 5.11377 2.34148 5.29491 2.26646C5.47606 2.19144 5.63843 2.0774 5.77046 1.93246L6.45046 1.18579Z" stroke="#00AA09" strokeWidth="1.5" />
                    <path d="M5.43652 7.43636L6.76986 8.76969L9.43652 6.10303" stroke="#00AA09" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" />
                </svg>
            );
        case "Defeated":
            return (
                <svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M6.45046 1.18579C6.57542 1.04852 6.72766 0.938847 6.89745 0.863805C7.06724 0.788762 7.25083 0.75 7.43646 0.75C7.62209 0.75 7.80568 0.788762 7.97546 0.863805C8.14525 0.938847 8.2975 1.04852 8.42246 1.18579L9.10246 1.93246C9.23449 2.0774 9.39686 2.19144 9.578 2.26646C9.75915 2.34148 9.95461 2.37562 10.1505 2.36646L11.1591 2.31979C11.3445 2.31106 11.5296 2.34111 11.7027 2.40802C11.8758 2.47494 12.033 2.57724 12.1642 2.70839C12.2955 2.83953 12.398 2.99664 12.465 3.16965C12.5321 3.34266 12.5623 3.52776 12.5538 3.71312L12.5065 4.72246C12.4973 4.91831 12.5314 5.11377 12.6065 5.29491C12.6815 5.47606 12.7955 5.63843 12.9405 5.77046L13.6871 6.45046C13.8244 6.57542 13.9341 6.72766 14.0091 6.89745C14.0842 7.06724 14.1229 7.25083 14.1229 7.43646C14.1229 7.62209 14.0842 7.80568 14.0091 7.97546C13.9341 8.14525 13.8244 8.2975 13.6871 8.42246L12.9405 9.10246C12.7955 9.23449 12.6815 9.39686 12.6065 9.578C12.5314 9.75915 12.4973 9.95461 12.5065 10.1505L12.5531 11.1591C12.5619 11.3445 12.5318 11.5296 12.4649 11.7027C12.398 11.8758 12.2957 12.033 12.1645 12.1642C12.0334 12.2955 11.8763 12.398 11.7033 12.465C11.5303 12.5321 11.3452 12.5623 11.1598 12.5538L10.1505 12.5065C9.95461 12.4973 9.75915 12.5314 9.578 12.6065C9.39686 12.6815 9.23449 12.7955 9.10246 12.9405L8.42246 13.6871C8.2975 13.8244 8.14525 13.9341 7.97546 14.0091C7.80568 14.0842 7.62209 14.1229 7.43646 14.1229C7.25083 14.1229 7.06724 14.0842 6.89745 14.0091C6.72766 13.9341 6.57542 13.8244 6.45046 13.6871L5.77046 12.9405C5.63843 12.7955 5.47606 12.6815 5.29491 12.6065C5.11377 12.5314 4.91831 12.4973 4.72246 12.5065L3.71379 12.5531C3.52844 12.5619 3.3433 12.5318 3.17023 12.4649C2.99716 12.398 2.83995 12.2957 2.70868 12.1645C2.57741 12.0334 2.47496 11.8763 2.40788 11.7033C2.3408 11.5303 2.31057 11.3452 2.31912 11.1598L2.36646 10.1505C2.37562 9.95461 2.34148 9.75915 2.26646 9.578C2.19144 9.39686 2.0774 9.23449 1.93246 9.10246L1.18579 8.42246C1.04852 8.2975 0.938847 8.14525 0.863805 7.97546C0.788762 7.80568 0.75 7.62209 0.75 7.43646C0.75 7.25083 0.788762 7.06724 0.863805 6.89745C0.938847 6.72766 1.04852 6.57542 1.18579 6.45046L1.93246 5.77046C2.0774 5.63843 2.19144 5.47606 2.26646 5.29491C2.34148 5.11377 2.37562 4.91831 2.36646 4.72246L2.31979 3.71379C2.31106 3.52844 2.34111 3.3433 2.40802 3.17023C2.47494 2.99716 2.57724 2.83995 2.70839 2.70868C2.83953 2.57741 2.99664 2.47496 3.16965 2.40788C3.34266 2.3408 3.52776 2.31057 3.71312 2.31912L4.72246 2.36646C4.91831 2.37562 5.11377 2.34148 5.29491 2.26646C5.47606 2.19144 5.63843 2.0774 5.77046 1.93246L6.45046 1.18579Z" stroke="#D70000" strokeWidth="1.5" />
                    <path d="M6.10303 9.10303L9.10303 6.10303" stroke="#D70000" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" />
                    <path d="M9.10303 9.10303L6.10303 6.10303" stroke="#D70000" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" />
                </svg>
            );
        case "Executable":
            return (
                <svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M6.45046 1.18579C6.57542 1.04852 6.72766 0.938847 6.89745 0.863805C7.06724 0.788762 7.25083 0.75 7.43646 0.75C7.62209 0.75 7.80568 0.788762 7.97546 0.863805C8.14525 0.938847 8.2975 1.04852 8.42246 1.18579L9.10246 1.93246C9.23449 2.0774 9.39686 2.19144 9.578 2.26646C9.75915 2.34148 9.95461 2.37562 10.1505 2.36646L11.1591 2.31979C11.3445 2.31106 11.5296 2.34111 11.7027 2.40802C11.8758 2.47494 12.033 2.57724 12.1642 2.70839C12.2955 2.83953 12.398 2.99664 12.465 3.16965C12.5321 3.34266 12.5623 3.52776 12.5538 3.71312L12.5065 4.72246C12.4973 4.91831 12.5314 5.11377 12.6065 5.29491C12.6815 5.47606 12.7955 5.63843 12.9405 5.77046L13.6871 6.45046C13.8244 6.57542 13.9341 6.72766 14.0091 6.89745C14.0842 7.06724 14.1229 7.25083 14.1229 7.43646C14.1229 7.62209 14.0842 7.80568 14.0091 7.97546C13.9341 8.14525 13.8244 8.2975 13.6871 8.42246L12.9405 9.10246C12.7955 9.23449 12.6815 9.39686 12.6065 9.578C12.5314 9.75915 12.4973 9.95461 12.5065 10.1505L12.5531 11.1591C12.5619 11.3445 12.5318 11.5296 12.4649 11.7027C12.398 11.8758 12.2957 12.033 12.1645 12.1642C12.0334 12.2955 11.8763 12.398 11.7033 12.465C11.5303 12.5321 11.3452 12.5623 11.1598 12.5538L10.1505 12.5065C9.95461 12.4973 9.75915 12.5314 9.578 12.6065C9.39686 12.6815 9.23449 12.7955 9.10246 12.9405L8.42246 13.6871C8.2975 13.8244 8.14525 13.9341 7.97546 14.0091C7.80568 14.0842 7.62209 14.1229 7.43646 14.1229C7.25083 14.1229 7.06724 14.0842 6.89745 14.0091C6.72766 13.9341 6.57542 13.8244 6.45046 13.6871L5.77046 12.9405C5.63843 12.7955 5.47606 12.6815 5.29491 12.6065C5.11377 12.5314 4.91831 12.4973 4.72246 12.5065L3.71379 12.5531C3.52844 12.5619 3.3433 12.5318 3.17023 12.4649C2.99716 12.398 2.83995 12.2957 2.70868 12.1645C2.57741 12.0334 2.47496 11.8763 2.40788 11.7033C2.3408 11.5303 2.31057 11.3452 2.31912 11.1598L2.36646 10.1505C2.37562 9.95461 2.34148 9.75915 2.26646 9.578C2.19144 9.39686 2.0774 9.23449 1.93246 9.10246L1.18579 8.42246C1.04852 8.2975 0.938847 8.14525 0.863805 7.97546C0.788762 7.80568 0.75 7.62209 0.75 7.43646C0.75 7.25083 0.788762 7.06724 0.863805 6.89745C0.938847 6.72766 1.04852 6.57542 1.18579 6.45046L1.93246 5.77046C2.0774 5.63843 2.19144 5.47606 2.26646 5.29491C2.34148 5.11377 2.37562 4.91831 2.36646 4.72246L2.31979 3.71379C2.31106 3.52844 2.34111 3.3433 2.40802 3.17023C2.47494 2.99716 2.57724 2.83995 2.70839 2.70868C2.83953 2.57741 2.99664 2.47496 3.16965 2.40788C3.34266 2.3408 3.52776 2.31057 3.71312 2.31912L4.72246 2.36646C4.91831 2.37562 5.11377 2.34148 5.29491 2.26646C5.47606 2.19144 5.63843 2.0774 5.77046 1.93246L6.45046 1.18579Z" stroke="#00AA09" stroke-width="1.5" />
                    <path d="M5.43652 7.43636L6.76986 8.76969L9.43652 6.10303" stroke="#00AA09" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
            );
        default:
            return null;
    }
};

export default VotingHistory;
